var tdwFilter={};
(function(){tdwFilter={items:[],init:function(){tdwFilter.items=[]},item:function(){this.templateDataId=this.templateType=this.loadType=this.jqueryObj=this.blockAtts=this.blockUid=void 0;this.is_ajax_running=this.isAjaxCallback=this.inComposer=!1;this.has_wp_query=!0;this._is_initialized=this.enabled_on_mobiles=!1},_initialize_item:function(a){if(!0!==a._is_initialized){if(!0===a.enabled_on_mobiles){a.jqueryObj.closest(".vc_column_container").addClass("tdw-filters-mobile");jQuery("body").addClass("tdw-filters");var d=
jQuery(".tdw-filters-button-mobile"),f=d.get(0);f=jQuery._data(f,"events");if(void 0===f||void 0===f.click)d.on("click",function(){jQuery("body").toggleClass("tdw-filters-open")})}else a.jqueryObj.closest(".vc_column_container").removeClass("tdw-filters-mobile"),jQuery("body").removeClass("tdw-filters");if(!0!==a.inComposer&&!1!==a.has_wp_query){window.onpopstate=function(b){if(null!==b.state)if("ajax"===a.jqueryObj.data("tdw-filter-load-type")){var c=[];(new URLSearchParams(window.location.search)).forEach(function(b,
g){-1!==g.indexOf("tdw_")&&jQuery(b.split(",")).each(function(b,e){b=a.jqueryObj.find('[data-term-slug="'+e+'"]');var d=a.jqueryObj.find('.select-filter-type option[value="'+e+'"]');b.length&&c.push({tax:g,slug:e,name:b.data("term-name")});d.length&&c.push({tax:g,slug:e,name:d.data("term-name")})})});jQuery(document).trigger("td_woo_filters_ajax_block_update",["on_popstate_reload",{tdw_filters:c,tdwFilterItemBlockAtts:a.blockAtts}]);a.jqueryObj.trigger("td_woo_filters_block_update",["on_popstate_reload",
c])}else window.location.reload()};a.jqueryObj.on("td_woo_filters_block_update",function(b,c,e){b="[td_woo_attribute_filter "+a.shortcodeAtts+"]";c=window.location.search;a.jqueryObj.is_ajax_running=!0;tdwFilter._ajaxLoadingStart(a.blockUid);jQuery.ajax({timeout:1E4,type:"POST",url:tdwFilter._getRestEndPoint("td-woo/do_job","tmp_blockUid="+a.blockUid+"&tdbLoadDataFromId="+a.templateDataId+"&tdbTemplateType="+a.templateType+c.replace("?","&")+"&td_woo_ajax=1&uuid="+tdwFilter._getUniqueID()),cache:!0,
data:{shortcode:b,replyHtml:""},dataType:"json",statusCode:{404:function(){console.log("tdwFilter - td_woo_filters_ajax_block_update - ERROR: 404 not found")},500:function(){console.log("tdwFilter - td_woo_filters_ajax_block_update - ERROR: 500 server error")}},success:function(b,c,e){null===b?console.log("tdwFilter - td_woo_filters_ajax_block_update - ERROR: Empty response received from server"):(a.jqueryObj.is_ajax_running=!1,tdwFilter._ajaxLoadingEnd(a.blockUid),_.has(b,"replyHtml")&&a.jqueryObj.replaceWith(b.replyHtml),
tdwFilter.deleteItem(a.blockUid),_.has(b,"replyJsForEval")&&window.eval(b.replyJsForEval))},error:function(a,b,c){console.log("tdwFilter - td_woo_filters_ajax_block_update - Error callback - textStatus: "+b+" errorThrown: "+c)}})});a.jqueryObj.on("click",".tdw-filters-clear-all",function(b){b.preventDefault();b.stopPropagation();b="ajax"===a.jqueryObj.data("tdw-filter-load-type");var c=new URLSearchParams(window.location.search),e=window.location.href;c.forEach(function(a,b){-1!==b.indexOf("tdw_")&&
(e=tdwFilter.removeQueryParam(e,b))});b?(jQuery(document).trigger("td_woo_filter_clear_all",{}),window.history.pushState({},"",e),a.jqueryObj.find(".tdw-filter-container").each(function(){var a=jQuery(this).find(".tdw-filter-items-wrapper");"SELECT"===a.prop("tagName")?a.find("option:selected").removeAttr("selected"):a.find("li").each(function(){jQuery(this).removeClass("selected")})}),jQuery(document).trigger("td_woo_filters_ajax_block_update",["td_woo_filter_clear_all",{}]),a.jqueryObj.trigger("td_woo_filters_block_update",
["td_woo_filter_clear_all",{}])):(window.history.pushState({},"",e),window.location.reload())});a.jqueryObj.on("click",".tdw-filter-item",function(b){var c=jQuery(this),e=c.parents("ul").data("taxonomy"),d=c.data("term-slug"),f=c.data("term-name");c.hasClass("selected")||c.hasClass("tdw-filter-link")?c.hasClass("selected")&&c.hasClass("tdw-filter-link")&&b.preventDefault():-1!==e.indexOf("tdw_")?(b=tdwFilter.removeQueryParam(window.location.href,"product-page"),b=b.replace(/\/page\/\d+/,""),"ajax"===
a.jqueryObj.data("tdw-filter-load-type")?(c.addClass("selected"),jQuery(document).trigger("td_woo_filter_add",{tax:e,term:d,term_name:f}),window.history.pushState({},"",tdwFilter.updateQuery(b,e,d)),jQuery(document).trigger("td_woo_filters_ajax_block_update",["td_woo_filter_add",{tdwFilterItemBlockAtts:a.blockAtts}]),a.jqueryObj.trigger("td_woo_filters_block_update",["td_woo_filter_add",{}])):window.location.href=tdwFilter.updateQuery(b,e,d)):console.log("invalid filter: "+e)});a.jqueryObj.on("change",
".select-filter-type",function(b){var c=jQuery(this);b=c.data("taxonomy");c=c.val();var e=jQuery("option:selected",this),d=e.data("term-name");(e=e.data("filter-link"))?window.location.href=e:-1!==b.indexOf("tdw_")?(e=tdwFilter.removeQueryParam(window.location.href,"product-page"),e=tdwFilter.removeQueryParam(e,b),e=e.replace(/\/page\/\d+/,""),"ajax"===a.jqueryObj.data("tdw-filter-load-type")?(jQuery(document).trigger("td_woo_filter_change",{tax:b,term:c,term_name:d}),window.history.pushState({},
"",tdwFilter.updateQuery(e,b,c)),jQuery(document).trigger("td_woo_filters_ajax_block_update",["td_woo_filter_change",{tdwFilterItemBlockAtts:a.blockAtts}]),a.jqueryObj.trigger("td_woo_filters_block_update",["td_woo_filter_change",{}])):window.location.href=tdwFilter.updateQuery(e,b,c)):console.log("invalid filter: "+b)});jQuery(document).on("td_woo_filter_remove",function(b,c){b=c.term;c=a.jqueryObj.find('[data-taxonomy="'+c.tax+'"]');"SELECT"===c.prop("tagName")?c.find("option:selected").removeAttr("selected"):
c.find("li[data-term-slug="+b+"]").removeClass("selected")});a.jqueryObj.find(".tdw-multi-select-wrapper").each(function(){var b=jQuery(this),c=b.find(".multi-select__selection");b.on("click",function(){jQuery(this).find(".multi-select").toggleClass("open")});b.find(".multi-select-options .multi-select-option").each(function(){var b=jQuery(this),d=b.data("term-name"),f=b.data("term-slug"),h=b.data("term-id"),k=b.parents(".multi-select-options").data("taxonomy"),l={name:d,slug:f,id:h,tax:k};b.hasClass("selected")&&
c.append('<span class="'+f+'">'+d+"</span>");b.on("click",function(e){c.find(".no-selection").remove();c.find("."+f).length||(c.append('<span class="'+f+'">'+d+"</span>"),b.addClass("selected"),a.jqueryObj.trigger("update",["td_woo_filter_update",l]))})})});a.jqueryObj.on("update",function(b,c,d){b=d.tax;c=d.slug;d=d.name;if(-1!==b.indexOf("tdw_")){var e=tdwFilter.removeQueryParam(window.location.href,"product-page");e=e.replace(/\/page\/\d+/,"");"ajax"===a.jqueryObj.data("tdw-filter-load-type")?
(jQuery(document).trigger("td_woo_filter_add",{tax:b,term:c,term_name:d}),window.history.pushState({},"",tdwFilter.updateQuery(e,b,c)),jQuery(document).trigger("td_woo_filters_ajax_block_update",["td_woo_filter_add",{tdwFilterItemBlockAtts:a.blockAtts}]),a.jqueryObj.trigger("td_woo_filters_block_update",["td_woo_filter_add",{}])):window.location.href=tdwFilter.updateQuery(e,b,c)}else console.log("invalid filter: "+b)});jQuery(document).on("click",function(b){b.target.classList.length&&(b.target.classList.contains("multi-select-options")||
b.target.classList.contains("multi-select-option")||b.target.classList.contains("tdw-multi-select-wrapper")||b.target.classList.contains("multi-select__selection"))||a.jqueryObj.find(".multi-select").removeClass("open")});if(!a.isAjaxCallback)jQuery(window).on("load",function(){if(tdwFiltersList.items.length)for(var b=0;b<tdwFiltersList.items.length;b++)tdwFiltersList.items[b].loadType=a.loadType});a._is_initialized=!0}}},addItem:function(a){if("undefined"===typeof a.blockUid)throw"item.blockUid is not defined";
tdwFilter.items.push(a);tdwFilter._initialize_item(a)},deleteItem:function(a){for(var d=0;d<tdwFilter.items.length;d++)if(tdwFilter.items[d].blockUid===a)return tdwFilter.items.splice(d,1),!0;return!1},updateQuery:function(a,d,f){var b=new RegExp("([?&])"+d+"=.*?(&|$)","i"),c=-1!==a.indexOf("?")?"&":"?";return a.match(b)?(c=new URLSearchParams(window.location.search),a.replace(b,"$1"+d+"="+c.get(d)+","+f+"$2")):""===f?a:a+c+d+"="+f},removeQueryParam:function(a,d){return a.replace(new RegExp("([?&])"+
d+"=.*?(&|$)","i"),"$1").replace(/[&|?]\s*$/,"")},_getUniqueID:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},_getRestEndPoint:function(a,d){return _.isEmpty(window.tdb_global_vars.permalinkStructure)?window.tdb_global_vars.wpRestUrl+a+"&"+d:window.tdb_global_vars.wpRestUrl+a+"?"+d},_ajaxLoadingStart:function(a){var d=jQuery("."+a);a=jQuery("#"+a);a.addClass("td_block_inner_overflow");a.css("height",
a.height());d.append('<div class="td-loader-gif td-loader-animation-start"></div>');tdLoadingBox.init(tds_theme_color_site_wide);setTimeout(function(){d.find(".td-loader-gif").removeClass("td-loader-animation-start").addClass("td-loader-animation-mid")},50);a.addClass("td_animated_long td_fadeOut_to_1")},_ajaxLoadingEnd:function(a){var d=jQuery("."+a);d.find(".td-loader-gif").removeClass("td-loader-animation-mid").addClass("td-loader-animation-end");setTimeout(function(){d.find(".td-loader-gif").remove();
tdLoadingBox.stop()},100);var f=jQuery("#"+a);f.removeClass("td_animated_long td_fadeOut_to_1");setTimeout(function(){d.find(".td_block_inner_overflow").removeClass("td_block_inner_overflow");f.css("height","auto")},50)}}})();jQuery().ready(function(){tdwFilter.init()});
